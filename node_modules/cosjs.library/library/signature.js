var crypto = require('crypto');

exports = module.exports = function (args,secret) {
    var keys = Object.keys(args).sort();
    var arr = [];
    keys.forEach(function(k){
        arr.push(k+'='+args[k]);
    });
    arr.push(secret);
    var str = arr.join('&');
    return md5(str).substr(0,16);
}

function md5(str){
    var _encrymd5 = crypto.createHash('md5');
    _encrymd5.update(str.toString(),'utf8');
    return _encrymd5.digest('hex');
}