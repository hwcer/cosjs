"use strict"
const crypto   = require('crypto');

exports = module.exports =  function(str,secret){
    var secret = secret || exports.secret;
    var cipher  = crypto.createCipher('aes-128-cfb',secret);
    var enc  = cipher .update(str, "utf8", "hex");
    enc += cipher .final("hex");
    var encrymd5 = crypto.createHash('md5');
    encrymd5.update(enc.toString(),'utf8');
    return encrymd5.digest('hex');
}


//密码密匙,千万不能改动,会使所有密码失效
exports.secret = 'szmzbzbzlp';